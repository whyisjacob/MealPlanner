<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
	 crossorigin="anonymous">


	<style>
		.mealList {
			list-style: none;
			font-family: Arial, Helvetica, sans-serif;
		}

		.mealList>li {
			margin: 10px;
		}

		.mealList>li>b {
			color: darkorange;
		}
	</style>

<body>
	<div class="container">

		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<ul class="navbar-nav">
				<li class="nav-item ">
					<a class="nav-link" href="/">Home </a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="newrecipe">Add a New Recipe</a>
				</li>
			</ul>
		</nav>
		<h1>Meal Planner</h1>
		<p>Planning meals can be a real challenge. The goal of this app is to help make planning meals quick and easy. You
			decide your favorite meals and it will randomly choose for you which ones to have on a given day.</p>
		<section>
			<ul id="mealList" class="mealList">
				<li id="sunday" class="dinnerList">
				</li>
				<li id="monday" class="dinnerList">

				</li>
				<li id="tuesday" class="dinnerList">

				</li>
				<li id="wednesday" class="dinnerList">

				</li>
				<li id="thursday" class="dinnerList">

				</li>
				<li id="friday" class="dinnerList">

				</li>
				<li id="saturday" class="dinnerList">

				</li>
			</ul>
			<button id="scanRecipes">Generate New List</button>
		</section>

		<footer>
			Release 1.1
			<br>
			<br>
			Known Bugs
			<ul>
				<li>Sorting Errors Out</li>
			</ul>
		</footer>
	</div>

</body>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="assets/js/recipes.js"></script>

<script>
	var chosenRecipes = [],
		recipeChosenAlready,
		recipeCount = recipes.length,
		daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
		x,
		savedRecipes;
	$(document).ready(function () {
		getSavedRecipeCount()
		console.log(savedRecipes)
	})

	function generateRecipeDisplay() {
		$('.dinnerList').each(function (i, val) {
			//Clear list
			$(val).html(' ');

			randomNumber()
			if (x == "ChooseNewRecipe") {
				randomNumber()
				if (x !== "ChooseNewRecipe") {
					$.get("/api/getRecipes" + x, function (data) {
						console.log(data)
						data.forEach(function (Recipe) {
							console.log(Recipe.RecipeName)
							$(val).append("<b>" + daysOfWeek[i] + "</b><br><h5>" + Recipe.RecipeName + "</h5>" + Recipe.RecipeLocation +
								", " + Recipe.MealType)

						})
					})
				} else {
					randomNumber()
					if (x !== "ChooseNewRecipe") {
						$(val).$.get("/api/getRecipes" + x, function (data) {
							console.log(data)
							data.forEach(function (Recipe) {
								console.log(Recipe.RecipeName)
								$(val).append("<b>" + daysOfWeek[i] + "</b><br><h5>" + Recipe.RecipeName + "</h5>" + Recipe.RecipeLocation +
									", " + Recipe.MealType)

							})
						})

					} else {

					}

				}
			} else {
				$.get("/api/getRecipes" + x, function (data) {
					console.log(data)
					data.forEach(function (Recipe) {
						console.log(Recipe.RecipeName)
						$(val).append("<b>" + daysOfWeek[i] + "</b><br><h5>" + Recipe.RecipeName + "</h5>" + Recipe.RecipeLocation +
							", " + Recipe.MealType)

					})
				})


			}
		})

	}

	function randomNumber() {
		var randomNumber = Math.floor(Math.random() * savedRecipes)
		var numbExists = chosenRecipes.includes(randomNumber)

		if (numbExists) {
			x = "ChooseNewRecipe"
			return x
		} else {
			chosenRecipes.push(randomNumber)
			x = randomNumber
			return x
		}

	}

	function getSavedRecipeCount() {
		$.get("/api/getFoodList", function (data) {
			savedRecipes = data.length;
			console.log(savedRecipes)
		})
	}

	$('#scanRecipes').on('click', function () {
		$('#scanRecipes').html('Refresh List')

		generateRecipeDisplay()

	})

	function getRecipeInfo(id) {
		$.get("/api/getRecipes" + id, function (data) {
			savedRecipes = data.length;
			console.log(savedRecipes)
		})
	}
</script>

</html>